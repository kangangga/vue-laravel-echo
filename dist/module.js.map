{"mappings":"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","sources":["src/main.js","src/VueEcho.js","src/utils/index.js","src/createBindingEvent.js"],"sourcesContent":["import \"pusher-js\";\nimport Echo from \"laravel-echo\";\nimport VueEcho from \"./VueEcho\";\nimport createBindingEvent from \"./createBindingEvent\";\n\nfunction install(app, options) {\n  const auth = options.auth || {};\n  const { headers } = auth;\n  const echo = new Echo({\n    ...options,\n    auth: {\n      headers: {\n        \"X-APP-ID\": options.key,\n        ...headers,\n      },\n    },\n  });\n\n  app.config.globalProperties.$echo = echo;\n\n  createBindingEvent(echo, options);\n\n  app.mixin(VueEcho(echo));\n}\n\nexport default { install };\n","import { isFunction } from \"./utils\";\n\nexport default (echo) => ({\n  created() {\n    const bindings = {};\n    const exluceEventMethods = [\"presence\", \"private\"];\n    this.$channel = this.$channel || {};\n    this.$options.sockets = this.$options.sockets || {};\n    const { sockets } = this.$options;\n\n    const registerEvent = (events, channel) => {\n      Object.keys(events).forEach(function (event) {\n        if (!exluceEventMethods.includes(event)) {\n          bindings[channel] = [];\n          this.$channel[channel].listen(event, (payload) => {\n            if (isFunction(events[event])) {\n              events[event].bind(this)(payload);\n            }\n          });\n          bindings[channel].push(event);\n        }\n      }, this);\n    };\n\n    Object.keys(sockets).forEach((channel) => {\n      if (channel.startsWith(\"private:\")) {\n        this.$channel[channel] = echo.private(channel.replace(\"private:\", \"\"));\n      } else if (channel.startsWith(\"presence:\")) {\n        this.$channel[channel] = echo.join(channel.replace(\"presence:\", \"\"));\n      } else {\n        this.$channel[channel] = echo.channel(channel);\n      }\n\n      echo[channel] = this.$channel[channel];\n      registerEvent(sockets[channel], channel);\n    });\n  },\n  beforeDestroy() {\n    for (const channel in bindings) {\n      if (Object.hasOwnProperty.call(bindings, channel)) {\n        let ch = echo.private(channel);\n        bindings[channel].forEach((listener) => {\n          ch.stopListening(listener);\n        });\n      }\n    }\n  },\n  destroy() {},\n});\n","export const isFunction = (obj) => typeof obj === \"function\";\n\nexport const isString = (value) => typeof value === \"string\";\n\nexport const isLaravelEcho = (obj) =>\n  !!obj && isFunction(obj.on) && isFunction(obj.emit);\n\nexport const isSocketIo = (obj) =>\n  !!obj && isFunction(obj.on) && isFunction(obj.emit);\n\nexport const unwrapIfSingle = (args) =>\n  args && args.length <= 1 ? args[0] : args;\n\nexport const pipe =\n  (...fns) =>\n  (x) =>\n    fns.reduce((v, f) => f(v), x);\n\nexport const prefixWith = (prefix) => (string) => prefix + string;\n\nexport const augmentMethod = (obj, methodKey, cb) => {\n  const originalFn = obj[methodKey];\n  obj[methodKey] = (...args) => {\n    originalFn.call(obj, ...args);\n    cb(...args);\n  };\n};\n\nexport const log = (...params) => {\n  if (process.env.NODE_ENV === \"development\") {\n    console.log(...params);\n  }\n};\n","import { log } from \"./utils\";\nimport camelCase from \"camelcase\";\n\n//https://pusher.com/docs/channels/using_channels/connection/#available-states\nconst phuserStatesName = [\n  \"failed\",\n  \"connected\",\n  \"connecting\",\n  \"initialized\",\n  \"unavailable\",\n  \"state_change\",\n];\n\n//https://socket.io/docs/v4/client-socket-instance/#events\nconst socketIOStatesName = [\n  \"connect\",\n  \"reconnect\",\n  \"connection\",\n  \"disconnect\",\n  \"connect_error\",\n  \"reconnect_attempt\",\n];\n\nfunction bindingEvent(echo, events) {\n  events.forEach((event) => {\n    let method = camelCase([\"on\", event]);\n    echo[method] = (callback) => {\n      connection.bind(event, callback);\n    };\n  });\n}\n\nexport default function createBindingEvent(echo, options) {\n  if (options.broadcaster == \"pusher\") {\n    const { connection } = echo.connector.pusher;\n    echo.on = (eventName, callback) => {\n      connection.bind(eventName, callback);\n    };\n\n    bindingEvent(echo, phuserStatesName);\n  } else if (options.broadcaster == \"socket.io\") {\n    echo.on = (event, callback) => {\n      echo.connector.socket.on(event, callback);\n    };\n\n    bindingEvent(echo, socketIOStatesName);\n  } else if (options.broadcaster == \"null\") {\n    echo.on = (event, callback) => {};\n  } else if (typeof options.broadcaster == \"function\") {\n    echo.on = (event, callback) => {};\n  }\n}\n"],"names":[],"version":3,"file":"module.js.map"}